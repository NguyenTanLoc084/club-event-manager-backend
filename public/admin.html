<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Qu·∫£n l√Ω s·ª± ki·ªán | Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Montserrat', sans-serif; background-color: #f8f9fa; }
        .table-container { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
    </style>
</head>
<body>
    <script>
        if (localStorage.getItem("isAdmin") !== "true") {
            window.location.href = "login.html";
        }
    </script>

    <nav class="navbar navbar-dark bg-dark mb-4">
        <div class="container">
            <span class="navbar-brand fw-bold">üìä Admin Dashboard</span>
            <button class="btn btn-outline-light btn-sm" onclick="logout()">ƒêƒÉng xu·∫•t</button>
        </div>
    </nav>

    <div class="container">
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="table-container">
                    <h4 class="fw-bold mb-4">üë• Danh s√°ch ng∆∞·ªùi tham gia</h4>
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead class="table-light">
                                <tr>
                                    <th>H·ªç v√† t√™n</th>
                                    <th>Kh√≥a</th>
                                    <th>Email</th>
                                    <th>Tr·∫°ng th√°i</th>
                                    <th>Ng√†y ƒëƒÉng k√Ω</th>
                                </tr>
                            </thead>
                            <tbody id="participantList">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function logout() {
            localStorage.removeItem("isAdmin");
            window.location.href = "login.html";
        }

        function loadParticipants() {
            fetch('/api/participants')
                .then(res => res.json())
                .then(data => {
                    const tbody = document.getElementById("participantList");
                    tbody.innerHTML = data.map(p => `
                        <tr>
                            <td class="fw-semibold">${p.fullname}</td>
                            <td>${p.course}</td>
                            <td>${p.email}</td>
                            <td>
                                <span class="badge ${p.checkedIn ? 'bg-success' : 'bg-warning text-dark'}">
                                    ${p.checkedIn ? 'ƒê√£ Check-in' : 'Ch·ªù tham gia'}
                                </span>
                            </td>
                            <td class="small text-muted">${new Date(p.registeredAt).toLocaleDateString('vi-VN')}</td>
                        </tr>
                    `).join('');
                });
        }

        // T·∫£i d·ªØ li·ªáu khi trang web m·ªü ra
        loadParticipants();
    </script>
</body>
</html>
