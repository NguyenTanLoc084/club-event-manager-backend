<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
    <div class="container">
        <a class="navbar-brand fw-bold d-flex align-items-center" href="index.html">
            <img src="logo.png" alt="Logo CLB" style="height: 40px; width: auto; margin-right: 10px; object-fit: contain;">
            <span class="d-none d-sm-inline">CLB Event Manager</span>
        </a>
        <div class="ms-auto d-flex align-items-center">
            <button class="btn btn-success btn-sm me-2 fw-bold" onclick="exportToExcel()">üìä Xu·∫•t Excel</button>
            <a href="create-event.html" class="btn btn-outline-info btn-sm me-2">T·∫°o S·ª± Ki·ªán</a>
            <button class="btn btn-danger btn-sm fw-bold" onclick="logout()">ƒêƒÉng xu·∫•t</button>
        </div>
    </div>
</nav>

<script>
    function exportToExcel() {
        fetch('/api/participants')
            .then(res => res.json())
            .then(data => {
                if (data.length === 0) {
                    alert("Ch∆∞a c√≥ d·ªØ li·ªáu ƒë·ªÉ xu·∫•t file!");
                    return;
                }
                const worksheetData = data.map(p => ({
                    "H·ªç v√† t√™n": p.fullname,
                    "Gi·ªõi t√≠nh": p.gender,
                    "Kh√≥a": p.course,
                    "Email": p.email,
                    "M√£ v√©": p.ticket,
                    "Tr·∫°ng th√°i": p.checkedIn ? "ƒê√£ Check-in" : "Ch·ªù tham gia",
                    "Ng√†y ƒëƒÉng k√Ω": new Date(p.registeredAt).toLocaleString('vi-VN')
                }));

                const worksheet = XLSX.utils.json_to_sheet(worksheetData);
                const workbook = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(workbook, worksheet, "Danh s√°ch tham gia");
                const fileName = `Danh_sach_tham_gia_${new Date().toLocaleDateString('vi-VN').replace(/\//g, '-')}.xlsx`;
                XLSX.writeFile(workbook, fileName);
            });
    }
</script>

